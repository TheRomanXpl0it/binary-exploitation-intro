from pwn import *

# p.recv() read all avaiable output
# p.recv(n) read n bytes
# p.recvuntil(string) read until string
# p.recvline() read a line
# p.recvline(False) read a line (discard newline char)
# p.recvall() read until EOF

# p.send(string) send
# p.sendline(string) send string + "\n"

# p.close()
# p.interactive() open a shell-like prompt

echo_srv = process("ncat -l 4356 --keep-open --exec '/bin/cat'", shell=True)
time.sleep(0.5)

p = remote("localhost", 4356)

p.sendline("hi")
assert p.recvline() == "hi\n"

p.sendline("hi")
assert p.recvline(False) == "hi" # do not read trailing \n

p.send("hey lascia entrare ascanio plis\n")
print "-------------------"
print p.recvuntil("lascia")
print "-------------------"
print p.recv()
print "-------------------"

p.interactive()

p.close()
echo_srv.close()

